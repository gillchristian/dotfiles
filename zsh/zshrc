# load antibody plugins
source ~/.antibody_plugins.sh

bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

export DOTFILES_DIR="$HOME/dev/dotfiles"

# Source all the configs
source ~/.zsh/aliases.zsh
source ~/.zsh/functions.zsh
source ~/.zsh/exports.zsh
source ~/.zsh/hooks.zsh

export PATH="$HOME/.yarn/bin:$HOME/.config/yarn/global/node_modules/.bin:$PATH"

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

eval `fnm env`

setxkbmap -option ctrl:nocaps # caps lock -> ctrl (for tmux)
setxkbmap us altgr-intl       # altgr i18n-izes (e.g. n + altgr = Ã±)

function zle-line-init zle-keymap-select {
  PROMPT=`~/dev/purs/target/release/purs prompt -k "$KEYMAP" -r "$?" --venv "${${VIRTUAL_ENV:t}%-*}"`
  zle reset-prompt
}
zle -N zle-line-init
zle -N zle-keymap-select

autoload -Uz add-zsh-hook

function _prompt_purs_precmd() {
  ~/dev/purs/target/release/purs precmd
}
add-zsh-hook precmd _prompt_purs_precmd
